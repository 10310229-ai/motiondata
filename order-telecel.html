<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Order - Telecel | Motion Data</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="assets/css/styles.css">
  <style>
    :root{--bg:#0a1810;--card:#1a2520;--input-bg:#ffffff;--muted:#b8c5bb;--accent:#84cc16;--green:#22c55e;--primary:#10b981}
    body{margin:0;font-family:Inter,system-ui,Arial;color:#fff}
    .wrap{max-width:960px;margin:2rem auto;padding:1rem;display:flex;flex-direction:column;align-items:center;position:relative;z-index:1}
    .form-grid{display:flex;flex-direction:column;align-items:center;gap:1rem;min-height:calc(100vh - 200px);justify-content:center;width:100%}
    .panel{background:linear-gradient(135deg,rgba(34,197,94,0.12),rgba(16,185,129,0.1));backdrop-filter:blur(20px);padding:2.5rem;border-radius:16px;border:1px solid rgba(132,204,22,0.2);width:100%;max-width:820px;box-shadow:0 8px 32px rgba(0,0,0,0.4)}
    .success-popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:linear-gradient(135deg,rgba(34,197,94,0.95),rgba(16,185,129,0.85));backdrop-filter:blur(20px);padding:3rem;border-radius:16px;border:2px solid rgba(132,204,22,0.4);width:90%;max-width:500px;box-shadow:0 20px 60px rgba(0,0,0,0.5);z-index:9999;text-align:center;animation:popupSlideIn 0.4s ease}
    .success-popup h2{margin:0 0 1rem 0;color:#fff;font-size:1.8rem;font-weight:800}
    .success-popup p{margin:0 0 1.5rem 0;color:#e0f2e0;font-size:1.1rem}
    .success-popup .popup-icon{font-size:4rem;margin-bottom:1rem;display:block}
    .success-popup .btn-popup{background:#22c55e;color:#04261a;border:none;padding:0.8rem 2rem;border-radius:10px;font-weight:800;cursor:pointer;font-size:1rem;transition:all 0.3s}
    .success-popup .btn-popup:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(34,197,94,0.4)}
    @keyframes popupSlideIn{from{transform:translate(-50%,-60%);opacity:0}to{transform:translate(-50%,-50%);opacity:1}}
    .popup-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9998;animation:fadeIn 0.3s ease}
    @keyframes fadeIn{from{opacity:0}to{opacity:1}}
    h1{font-size:1.1rem;margin:0 0 .6rem;color:var(--accent);font-weight:800}
    label{display:block;color:#fff;font-weight:700;margin-bottom:.35rem}
    input[type="text"], select, textarea{width:100%;padding:.7rem;border-radius:10px;border:1px solid rgba(0,0,0,0.08);background:var(--input-bg);color:#04111a}
    .center{display:flex;justify-content:center}
    .btn-order{background:var(--green);color:#04261a;border-radius:10px;padding:.6rem 1rem;border:none;font-weight:800;cursor:pointer;transition:all 0.3s}
    .btn-order:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(34,197,94,0.4)}
    .hint{font-size:.9rem;color:var(--muted);margin-top:.35rem}
  </style>
</head>
<body>
  <div class="wrap">
    <header style="margin-bottom:1rem;text-align:center"><a href="services.html" style="color:var(--accent);text-decoration:none;font-weight:700">&larr; Back</a></header>

    <div class="form-grid">
      <section class="panel" aria-labelledby="telecel-order">
        <div>
          <h1 id="telecel-order">SEND SINGLE ORDER â€” Telecel</h1>
        </div>

        <form id="telecelForm">
          <div style="margin-top:1rem">
            <label for="msisdn">Type Number</label>
            <input id="msisdn" name="msisdn" type="text" placeholder="must be 10 digits!" pattern="\d{10}" inputmode="numeric" maxlength="10" required>
            <div class="hint">Enter recipient mobile number (10 digits). Example: 0201234567</div>
          </div>

          <div style="margin-top:1rem">
            <label for="email">Your Email</label>
            <input id="email" name="email" type="email" placeholder="you@example.com" required>
            <div class="hint">We will use this email to process the payment receipt.</div>
          </div>

          <div style="margin-top:1rem">
            <label for="packageSelectTelecel">Telecel Packages</label>
            <select id="packageSelectTelecel" name="package_telecel" disabled>
              <option value="">-- OUT OF STOCK --</option>
              <!-- packages currently out of stock -->
            </select>
            <div class="hint">Select a Telecel bundle to purchase. Prices shown in GHS.</div>
          </div>

          <div style="margin-top:1.25rem" class="center">
            <button type="submit" class="btn-order">ORDER TELECEL</button>
          </div>
        </form>
      </section>
    </div>
  </div>

  <script src="assets/js/toast.js"></script>
  <script src="assets/js/supabase.js"></script>
  <script src="https://js.paystack.co/v1/inline.js"></script>
  <script src="js/order-telecel.js"></script>
  <script>
    // Check if user is logged in - disable form if not
    document.addEventListener('DOMContentLoaded', function() {
      const currentUser = localStorage.getItem('currentUser');
      if (!currentUser) {
        const form = document.getElementById('telecelForm');
        const submitBtn = form?.querySelector('button[type="submit"]');
        
        if (form) {
          // Disable all form inputs
          const inputs = form.querySelectorAll('input, select, button');
          inputs.forEach(input => input.disabled = true);
          
          // Show login prompt
          if (submitBtn) {
            submitBtn.innerHTML = '<i class="fas fa-lock"></i> Login Required';
            submitBtn.style.opacity = '0.6';
            submitBtn.style.cursor = 'not-allowed';
          }
          
          // Add click handler to show login message
          form.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            if (typeof showToast === 'function') {
              showToast('Please login or create an account to place an order.', 'warning');
            } else {
              alert('Please login or create an account to place an order.');
            }
            // Redirect to home page after showing message
            setTimeout(() => {
              window.location.href = 'index.html';
            }, 2000);
          }, true);
        }
      }
    });
  </script>
</body>
</html>
